# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'UpdateWindow.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import *
import BackGround
import sqlite3

class Ui_UpdateWindow(object):
    def setupUi(self, UpdateWindow):
        UpdateWindow.setObjectName("UpdateWindow")
        UpdateWindow.resize(857, 684)
        self.centralwidget = QtWidgets.QWidget(UpdateWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.InsertBackground = QtWidgets.QLabel(self.centralwidget)
        self.InsertBackground.setGeometry(QtCore.QRect(0, 0, 850, 631))
        self.InsertBackground.setStyleSheet("background-image: url(:/Main/background.png);")
        self.InsertBackground.setText("")
        self.InsertBackground.setObjectName("InsertBackground")
        self.InsertTitel = QtWidgets.QLabel(self.centralwidget)
        self.InsertTitel.setGeometry(QtCore.QRect(10, 40, 811, 80))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(28)
        font.setBold(True)
        font.setWeight(75)
        self.InsertTitel.setFont(font)
        self.InsertTitel.setStyleSheet("color: rgb(255, 255, 255);")
        self.InsertTitel.setAlignment(QtCore.Qt.AlignCenter)
        self.InsertTitel.setObjectName("InsertTitel")
        self.FindIdToUpdate = QtWidgets.QFrame(self.centralwidget)
        self.FindIdToUpdate.setGeometry(QtCore.QRect(-1, 130, 850, 520))
        self.FindIdToUpdate.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.FindIdToUpdate.setFrameShadow(QtWidgets.QFrame.Raised)
        self.FindIdToUpdate.setObjectName("FindIdToUpdate")
        self.LabelStudentId = QtWidgets.QLabel(self.FindIdToUpdate)
        self.LabelStudentId.setGeometry(QtCore.QRect(40, 50, 250, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.LabelStudentId.setFont(font)
        self.LabelStudentId.setStyleSheet("color: rgb(255, 255, 255);")
        self.LabelStudentId.setObjectName("LabelStudentId")
        self.LabelStudentName = QtWidgets.QLabel(self.FindIdToUpdate)
        self.LabelStudentName.setGeometry(QtCore.QRect(40, 130, 250, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.LabelStudentName.setFont(font)
        self.LabelStudentName.setStyleSheet("color: rgb(255, 255, 255);")
        self.LabelStudentName.setObjectName("LabelStudentName")
        self.LabelStudentAdress = QtWidgets.QLabel(self.FindIdToUpdate)
        self.LabelStudentAdress.setGeometry(QtCore.QRect(40, 200, 250, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.LabelStudentAdress.setFont(font)
        self.LabelStudentAdress.setStyleSheet("color: rgb(255, 255, 255);")
        self.LabelStudentAdress.setObjectName("LabelStudentAdress")
        self.LabelClassID = QtWidgets.QLabel(self.FindIdToUpdate)
        self.LabelClassID.setGeometry(QtCore.QRect(40, 270, 250, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.LabelClassID.setFont(font)
        self.LabelClassID.setStyleSheet("color: rgb(255, 255, 255);")
        self.LabelClassID.setObjectName("LabelClassID")
        self.TextOldId = QtWidgets.QLineEdit(self.FindIdToUpdate)
        self.TextOldId.setGeometry(QtCore.QRect(320, 50, 300, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        self.TextOldId.setFont(font)
        self.TextOldId.setText("")
        self.TextOldId.setObjectName("TextOldId")
        self.ButtonFind = QtWidgets.QPushButton(self.FindIdToUpdate)
        self.ButtonFind.setGeometry(QtCore.QRect(650, 50, 150, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.ButtonFind.setFont(font)
        self.ButtonFind.setObjectName("ButtonFind")
        self.TextStudentName = QtWidgets.QLineEdit(self.FindIdToUpdate)
        self.TextStudentName.setGeometry(QtCore.QRect(320, 120, 300, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        self.TextStudentName.setFont(font)
        self.TextStudentName.setText("")
        self.TextStudentName.setObjectName("TextStudentName")
        self.TextStudentAddress = QtWidgets.QLineEdit(self.FindIdToUpdate)
        self.TextStudentAddress.setGeometry(QtCore.QRect(320, 190, 300, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        self.TextStudentAddress.setFont(font)
        self.TextStudentAddress.setText("")
        self.TextStudentAddress.setObjectName("TextStudentAddress")
        self.TextClassID = QtWidgets.QLineEdit(self.FindIdToUpdate)
        self.TextClassID.setGeometry(QtCore.QRect(320, 260, 300, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        self.TextClassID.setFont(font)
        self.TextClassID.setText("")
        self.TextClassID.setObjectName("TextClassID")
        self.ButtonInsert = QtWidgets.QPushButton(self.FindIdToUpdate)
        self.ButtonInsert.setGeometry(QtCore.QRect(175, 390, 150, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.ButtonInsert.setFont(font)
        self.ButtonInsert.setObjectName("ButtonInsert")
        self.ButtonQuit = QtWidgets.QPushButton(self.FindIdToUpdate)
        self.ButtonQuit.setGeometry(QtCore.QRect(500, 390, 150, 50))
        font = QtGui.QFont()
        font.setFamily("Consolas")
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.ButtonQuit.setFont(font)
        self.ButtonQuit.setObjectName("ButtonQuit")
        UpdateWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(UpdateWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 857, 26))
        self.menubar.setObjectName("menubar")
        UpdateWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(UpdateWindow)
        self.statusbar.setObjectName("statusbar")
        UpdateWindow.setStatusBar(self.statusbar)

        self.retranslateUi(UpdateWindow)
        QtCore.QMetaObject.connectSlotsByName(UpdateWindow)
        # ? Connect widget
        # Button quit
        self.ButtonQuit.clicked.connect(lambda:self.close(UpdateWindow))
        self.ButtonFind.clicked.connect(self.find)
        self.ButtonInsert.clicked.connect(self.insert)
        self.TextStudentAddress.setDisabled(True)
        self.TextClassID.setDisabled(True)
        self.TextStudentName.setDisabled(True)

        # ? set title
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("icon.png"), QtGui.QIcon.Selected, QtGui.QIcon.On)
        UpdateWindow.setWindowIcon(icon)

# Quit
    def close(self,UpdateWindow):
        mess = QMessageBox()
        mess.setIcon(QMessageBox.Warning)
        mess.setWindowTitle("Window Close")
        mess.setWindowIcon(QtGui.QIcon('warning.png'))
        mess.setStyleSheet("QLabel{min-height:30 px; font-size: 24px;}")
        mess.setText("Are you sure you want to close the windodw ?")
        mess.setStandardButtons(QMessageBox.Yes | QMessageBox.No )
        question = mess.exec_()
        if question == QMessageBox.Yes :
            UpdateWindow.hide()

    def find(self):
        connection = sqlite3.connect('StudentManagement.db')
        cur = connection.cursor()
        query = """SELECT * FROM STUDENT WHERE StudentID = '{}'""".format(self.TextOldId.text())
        cur.execute(query)
        data = cur.fetchall()

    # ? thÃªm mess
        if not data:
            mess = QMessageBox()
            mess.setIcon(QMessageBox.Critical)
            mess.setWindowIcon(QtGui.QIcon('cancel.png'))
            mess.setStyleSheet("QLabel{min-height:30 px; font-size: 24px;}")
            mess.setWindowTitle("Error")
            mess.setText(" Student is not exist ")
            mess.exec_()
        else:
            mess = QMessageBox()
            mess.setIcon(QMessageBox.Information)
            mess.setWindowIcon(QtGui.QIcon('information.png'))
            mess.setStyleSheet("QLabel{min-height:30 px; font-size: 24px;}")
            mess.setWindowTitle("Congratulations")
            mess.setText(" Found student has ID : {} ".format(self.TextOldId.text()))
            mess.exec_()
            self.TextStudentAddress.setEnabled(True)
            self.TextClassID.setEnabled(True)
            self.TextStudentName.setEnabled(True)

    def insert(self):
        try:
            connection = sqlite3.connect('StudentManagement.db')
            cur = connection.cursor()
            query = """UPDATE Student SET StudentName = '{}',StudentAddress = '{}',ClassID = '{}' WHERE StudentID = '{}'""".format(self.TextStudentName.text(),self.TextStudentAddress.text(),self.TextClassID.text(),self.TextOldId.text())
            cur.execute(query)
            connection.commit()
            mess = QMessageBox()
            mess.setIcon(QMessageBox.Information)
            mess.setWindowIcon(QtGui.QIcon('information.png'))
            mess.setStyleSheet("QLabel{min-height:30 px; font-size: 24px;}")
            mess.setWindowTitle("Congratulations")
            mess.setText("Update Successful")
            mess.exec_()
        except:
            mess = QMessageBox()
            mess.setIcon(QMessageBox.Critical)
            mess.setStyleSheet("QLabel{min-height:30 px; font-size: 24px;}")
            mess.setWindowIcon(QtGui.QIcon('cancel.png'))
            mess.setWindowTitle("Error")
            mess.setText(" Error ")
            mess.exec_()

    def retranslateUi(self, UpdateWindow):
        _translate = QtCore.QCoreApplication.translate
        UpdateWindow.setWindowTitle(_translate("UpdateWindow", "Update"))
        self.InsertBackground.setWhatsThis(_translate("UpdateWindow", "<html><head/><body><p><img src=\":/Main/background.png\"/></p></body></html>"))
        self.InsertTitel.setText(_translate("UpdateWindow", "Update Student"))
        self.LabelStudentId.setText(_translate("UpdateWindow", "Student ID"))
        self.LabelStudentName.setText(_translate("UpdateWindow", "Student Name"))
        self.LabelStudentAdress.setText(_translate("UpdateWindow", "Student Address"))
        self.LabelClassID.setText(_translate("UpdateWindow", "Class ID"))
        self.ButtonFind.setText(_translate("UpdateWindow", "Find"))
        self.ButtonInsert.setText(_translate("UpdateWindow", "Update"))
        self.ButtonQuit.setText(_translate("UpdateWindow", "Quit"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    UpdateWindow = QtWidgets.QMainWindow()
    ui = Ui_UpdateWindow()
    ui.setupUi(UpdateWindow)
    UpdateWindow.show()
    sys.exit(app.exec_())
